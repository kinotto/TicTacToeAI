!function(){"use strict";function t(t,e){this.x=t,this.y=e}function e(t){this.board=[];for(var e=0;e<i;e++)this.board[e]=t?t[e]:n.EMPTY}function r(){}function o(t,e){this.cell=t,this.indexes=e}var n={EMPTY:"",X:"X",O:"O"},i=9;e.prototype.oppositePlayer=function(t){return t===n.X?n.O:t===n.O?n.X:n.EMPTY},e.prototype.copy=function(){var t=Object.create(this);return t.board=[],[].push.apply(t.board,this.board),t};var a=function(t){return t.x+3*t.y};e.prototype.makeMove=function(t,e){try{if(this.cellAt(e)!==n.EMPTY)throw new Error("Cell is already taken");this.board[a(e)]=t}catch(t){throw t}},e.prototype.cellAt=function(t){return this.board[a(t)]},e.prototype.winner=function(){for(var t=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]],e=this.board,r=0;r<t.length;r++)if(e[t[r][0]]!==n.EMPTY&&e[t[r][0]]===e[t[r][1]]&&e[t[r][1]]===e[t[r][2]])return new o(e[t[r][0]],t[r]);return this.boardFull()?new o(n.EMPTY,null):null},e.prototype.boardFull=function(){for(var t=0;t<i;t++)if(this.board[t]===n.EMPTY)return!1;return!0},e.prototype.emptySlots=function(){for(var e=[],r=0;r<3;r++)for(var o=0;o<3;o++){var i=new t(o,r),a=this.cellAt(i);a===n.EMPTY&&e.push(i)}return e},r.prototype.initialize=function(t,e){this.team=t,this.gameBoard=e},r.prototype.makeMove=function(){for(var t,e,r=this.gameBoard.emptySlots(),o=-1,n=null,i=0;i<r.length;i++){var a=r[i];e=this.gameBoard.copy(),e.makeMove(this.team,a),t=this.minimax(e,this.gameBoard.oppositePlayer(this.team)),t>=o&&(o=t,n=a)}return n},r.prototype.minimax=function(t,e){var r=-1,o=1;e!=this.team&&(o=-1);var n=t.winner();if(null!==n)return this.evaluateWinner(n.cell);for(var i,a,u=t.emptySlots(),l=0;l<u.length;l++)a=t.copy(),a.makeMove(e,u[l]),(i=o*this.minimax(a,t.oppositePlayer(e)))>=r&&(r=i);return o*r},r.prototype.evaluateWinner=function(t){return null===t||t===n.EMPTY?0:t===this.team?1:-1},"undefined"!=typeof module&&module.exports?module.exports={TicTacToeBoard:e,TicTacToeAIPlayer:r}:window.TicTacToe={TicTacToeBoard:e,TicTacToeAIPlayer:r}}();